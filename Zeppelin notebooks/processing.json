{"paragraphs":[{"text":"%pyspark\r\nfrom pyspark.sql.functions import count, avg, round, col\r\n\r\ndata = \"hdfs:///user/root/data/movies_data\"\r\nitems = \"hdfs:///user/root/data/movies_items\"\r\nusers = \"hdfs:///user/root/data/users_data\"","user":"anonymous","dateUpdated":"2024-11-12T19:05:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731419037772_134948365","id":"20241112-134357_530700622","dateCreated":"2024-11-12T13:43:57+0000","dateStarted":"2024-11-12T19:05:39+0000","dateFinished":"2024-11-12T19:05:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:290"},{"text":"%pyspark\nmovies_data = spark.read.csv(data, sep = '\\t' , header = False , inferSchema=True).toDF(\"user_id\", \"item_id\", \"rating\", \"timestamp\")","user":"anonymous","dateUpdated":"2024-11-12T19:05:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731419360804_1445851332","id":"20241112-134920_971781899","dateCreated":"2024-11-12T13:49:20+0000","dateStarted":"2024-11-12T19:05:44+0000","dateFinished":"2024-11-12T19:05:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:291"},{"text":"%pyspark\nmovies_data.show(5)","user":"anonymous","dateUpdated":"2024-11-12T19:05:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+------+---------+\n|user_id|item_id|rating|timestamp|\n+-------+-------+------+---------+\n|    196|    242|     3|881250949|\n|    186|    302|     3|891717742|\n|     22|    377|     1|878887116|\n|    244|     51|     2|880606923|\n|    166|    346|     1|886397596|\n+-------+-------+------+---------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731419466886_1605258326","id":"20241112-135106_1920317063","dateCreated":"2024-11-12T13:51:06+0000","dateStarted":"2024-11-12T19:05:48+0000","dateFinished":"2024-11-12T19:05:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:292"},{"text":"%pyspark\nmovies_data = movies_data.withColumnRenamed(\"item_id\",\"movie_id\")","user":"anonymous","dateUpdated":"2024-11-12T19:06:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731419676226_-1904696976","id":"20241112-135436_1435092503","dateCreated":"2024-11-12T13:54:36+0000","dateStarted":"2024-11-12T19:06:27+0000","dateFinished":"2024-11-12T19:06:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:293"},{"text":"%pyspark\nfrom pyspark.sql.functions import from_unixtime, date_format\n\nmovies_data_formatted = movies_data.withColumn(\"timestamp\", date_format(from_unixtime(movies_data[\"timestamp\"]), \"yyyy-MM-dd HH:mm:ss\"))\n","user":"anonymous","dateUpdated":"2024-11-12T19:06:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731419510640_-1768742697","id":"20241112-135150_1328529584","dateCreated":"2024-11-12T13:51:50+0000","dateStarted":"2024-11-12T19:06:29+0000","dateFinished":"2024-11-12T19:06:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:294"},{"text":"%pyspark\nmovies_data_formatted.show(5)","user":"anonymous","dateUpdated":"2024-11-12T19:06:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------+------+-------------------+\n|user_id|movie_id|rating|          timestamp|\n+-------+--------+------+-------------------+\n|    196|     242|     3|1997-12-04 15:55:49|\n|    186|     302|     3|1998-04-04 19:22:22|\n|     22|     377|     1|1997-11-07 07:18:36|\n|    244|      51|     2|1997-11-27 05:02:03|\n|    166|     346|     1|1998-02-02 05:33:16|\n+-------+--------+------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731419921224_-1482675050","id":"20241112-135841_2121750154","dateCreated":"2024-11-12T13:58:41+0000","dateStarted":"2024-11-12T19:06:31+0000","dateFinished":"2024-11-12T19:06:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:295"},{"text":"%pyspark\nusers_df = movies_data_formatted.groupby(\"user_id\").agg(count(\"rating\").alias(\"user_rating_count\"))\nusers_df.show(5)","user":"anonymous","dateUpdated":"2024-11-12T19:07:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|user_id|user_rating_count|\n+-------+-----------------+\n|    148|               65|\n|    463|              133|\n|    471|               31|\n|    496|              129|\n|    833|              267|\n+-------+-----------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731435675216_277560659","id":"20241112-182115_128925192","dateCreated":"2024-11-12T18:21:15+0000","dateStarted":"2024-11-12T19:07:12+0000","dateFinished":"2024-11-12T19:07:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:296"},{"text":"%pyspark\nactive_users = users_df.filter(users_df[\"user_rating_count\"] >= 50 ).orderBy(\"user_rating_count\", ascending= False)\nactive_users.show(5)","user":"anonymous","dateUpdated":"2024-11-12T19:07:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|user_id|user_rating_count|\n+-------+-----------------+\n|    405|              737|\n|    655|              685|\n|     13|              636|\n|    450|              540|\n|    276|              518|\n+-------+-----------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731435934471_-2075980656","id":"20241112-182534_916495682","dateCreated":"2024-11-12T18:25:34+0000","dateStarted":"2024-11-12T19:07:18+0000","dateFinished":"2024-11-12T19:07:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:297"},{"text":"%pyspark\nusers_data = spark.read.csv(users, sep = \"|\", header = False , inferSchema=True).toDF(\"user_id\", \"age\", \"gender\", \"occupation\", \"zip\")\nusers_data.show(5)","user":"anonymous","dateUpdated":"2024-11-12T18:38:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+----------+-----+\n|user_id|age|gender|occupation|  zip|\n+-------+---+------+----------+-----+\n|      1| 24|     M|technician|85711|\n|      2| 53|     F|     other|94043|\n|      3| 23|     M|    writer|32067|\n|      4| 24|     M|technician|43537|\n|      5| 33|     F|     other|15213|\n+-------+---+------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731436183408_-1201306320","id":"20241112-182943_2123477899","dateCreated":"2024-11-12T18:29:43+0000","dateStarted":"2024-11-12T18:32:12+0000","dateFinished":"2024-11-12T18:32:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:299"},{"text":"%pyspark\n\nactive_users_data = active_users.join(users_data, on=\"user_id\", how=\"left\")\nactive_users_data.show(5)","user":"anonymous","dateUpdated":"2024-11-12T18:38:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+---+------+----------+-----+\n|user_id|user_rating_count|age|gender|occupation|  zip|\n+-------+-----------------+---+------+----------+-----+\n|    405|              737| 22|     F|healthcare|10019|\n|    655|              685| 50|     F|healthcare|60657|\n|     13|              636| 47|     M|  educator|29206|\n|    450|              540| 35|     F|  educator|11758|\n|    276|              518| 21|     M|   student|95064|\n+-------+-----------------+---+------+----------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731436346645_-1657420946","id":"20241112-183226_1524025418","dateCreated":"2024-11-12T18:32:26+0000","dateStarted":"2024-11-12T18:33:16+0000","dateFinished":"2024-11-12T18:33:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:300"},{"text":"%pyspark\nfrom pyspark.sql import SparkSession\n\n\nspark_hive = SparkSession.builder \\\n    .appName(\"WriteToHive\") \\\n    .config(\"spark.sql.warehouse.dir\", \"/user/hive/warehouse\") \\\n    .enableHiveSupport() \\\n    .getOrCreate()","user":"anonymous","dateUpdated":"2024-11-12T19:07:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731436477307_1687032677","id":"20241112-183437_804731280","dateCreated":"2024-11-12T18:34:37+0000","dateStarted":"2024-11-12T19:07:42+0000","dateFinished":"2024-11-12T19:07:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:301"},{"text":"%sql\nCREATE TABLE IF NOT EXISTS active_users_details (\n    user_id INT,\n    user_rating_count INT,\n    age INT,\n    gender STRING,\n    occupation STRING,\n    zip STRING\n)\nSTORED AS PARQUET","user":"anonymous","dateUpdated":"2024-11-12T19:07:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1731436492367_1731845795","id":"20241112-183452_747978688","dateCreated":"2024-11-12T18:34:52+0000","dateStarted":"2024-11-12T19:07:45+0000","dateFinished":"2024-11-12T19:07:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:302"},{"text":"%pyspark\nactive_users_data.write.mode(\"overwrite\").saveAsTable(\"active_users_details\")","user":"anonymous","dateUpdated":"2024-11-12T19:07:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731436827636_782946093","id":"20241112-184027_562033497","dateCreated":"2024-11-12T18:40:27+0000","dateStarted":"2024-11-12T19:07:48+0000","dateFinished":"2024-11-12T19:08:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:303"},{"title":"most active gender","text":"%sql \nselect  gender\n, count(user_id) as count_users, sum(user_rating_count) as total_ratings from active_users_details group by gender\n","user":"anonymous","dateUpdated":"2024-11-12T19:13:46+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{},"pieChart":{}},"commonSetting":{},"keys":[{"name":"gender","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count_users","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"gender\tcount_users\ttotal_ratings\nF\t143\t21797\nM\t425\t66674\n"}]},"apps":[],"jobName":"paragraph_1731437102749_-1618076391","id":"20241112-184502_2112721875","dateCreated":"2024-11-12T18:45:02+0000","dateStarted":"2024-11-12T19:09:28+0000","dateFinished":"2024-11-12T19:09:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:304"},{"text":"%sql\nselect occupation, count(user_id) as count_users from active_users_details group by occupation order by count_users desc","user":"anonymous","dateUpdated":"2024-11-12T19:14:20+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"stackedAreaChart","height":412.4,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"occupation","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count_users","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"occupation\tcount_users\nstudent\t126\nother\t65\neducator\t49\nengineer\t48\nprogrammer\t43\nadministrator\t42\nwriter\t32\nlibrarian\t28\nexecutive\t22\ntechnician\t19\nartist\t16\nscientist\t16\nhealthcare\t12\nentertainment\t12\nmarketing\t10\nretired\t9\nlawyer\t6\nsalesman\t5\nnone\t4\ndoctor\t3\nhomemaker\t1\n"}]},"apps":[],"jobName":"paragraph_1731437321221_1656227050","id":"20241112-184841_747316381","dateCreated":"2024-11-12T18:48:41+0000","dateStarted":"2024-11-12T19:09:40+0000","dateFinished":"2024-11-12T19:09:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:305","title":"most active occupations"},{"text":"%sql\nselect case when age < 25 then \"Young\" \nwhen age < 40 then \"adult\"\nwhen age > 40 then \"Old\"\nelse \"childern\" end as Age_Group, count(user_id) as count_users from active_users_details group by Age_Group  ","user":"anonymous","dateUpdated":"2024-11-12T19:14:30+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Age_Group\tcount_users\nOld\t137\nadult\t276\nYoung\t146\nchildern\t9\n"}]},"apps":[],"jobName":"paragraph_1731437629215_-635861710","id":"20241112-185349_17639972","dateCreated":"2024-11-12T18:53:49+0000","dateStarted":"2024-11-12T19:10:05+0000","dateFinished":"2024-11-12T19:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:306","title":"most active Age groups"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import year, month,dayofweek, date_format, from_unixtime\n\nmovies_data_formatted = movies_data_formatted \\\n    .withColumn(\"year\", year(\"timestamp\")) \\\n    .withColumn(\"month\", month(\"timestamp\")) \\\n    .withColumn(\"day_of_week\", dayofweek(\"timestamp\"))\n    \nmovies_data_formatted.show(5)","user":"anonymous","dateUpdated":"2024-11-12T19:33:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731438627613_-831117703","id":"20241112-191027_1306681592","dateCreated":"2024-11-12T19:10:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3263","dateFinished":"2024-11-12T19:33:47+0000","dateStarted":"2024-11-12T19:33:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------+------+-------------------+----+-----+-----------+\n|user_id|movie_id|rating|          timestamp|year|month|day_of_week|\n+-------+--------+------+-------------------+----+-----+-----------+\n|    196|     242|     3|1997-12-04 15:55:49|1997|   12|          5|\n|    186|     302|     3|1998-04-04 19:22:22|1998|    4|          7|\n|     22|     377|     1|1997-11-07 07:18:36|1997|   11|          6|\n|    244|      51|     2|1997-11-27 05:02:03|1997|   11|          5|\n|    166|     346|     1|1998-02-02 05:33:16|1998|    2|          2|\n+-------+--------+------+-------------------+----+-----+-----------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\nmovies_data_grouped = movies_data_formatted.groupby([\"year\"]).agg(count(\"rating\").alias(\"ratingCount\")).orderBy(\"ratingCount\", ascending = False)\nmovies_data_grouped.show()","user":"anonymous","dateUpdated":"2024-11-12T19:28:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731439154652_-647829441","id":"20241112-191914_1560698748","dateCreated":"2024-11-12T19:19:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3538","dateFinished":"2024-11-12T19:28:13+0000","dateStarted":"2024-11-12T19:28:11+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----------+\n|year|ratingCount|\n+----+-----------+\n|1997|      52899|\n|1998|      47101|\n+----+-----------+\n\n"}]}},{"text":"%pyspark\nactive_months = movies_data_formatted.groupby([\"month\"]).agg(count(\"rating\").alias(\"ratingCount\")).orderBy(\"ratingCount\", ascending = False)\nactive_months.show()","user":"anonymous","dateUpdated":"2024-11-12T19:29:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731439698427_623578494","id":"20241112-192818_1485988873","dateCreated":"2024-11-12T19:28:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3797","dateFinished":"2024-11-12T19:29:10+0000","dateStarted":"2024-11-12T19:29:08+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----------+\n|month|ratingCount|\n+-----+-----------+\n|   11|      23980|\n|    1|      14095|\n|    3|      12656|\n|   12|      11911|\n|    2|      10991|\n|   10|      10304|\n|    4|       9359|\n|    9|       6704|\n+-----+-----------+\n\n"}]}},{"text":"%pyspark\nactive_days = movies_data_formatted.groupby([\"day_of_week\"]).agg(count(\"rating\").alias(\"ratingCount\")).orderBy(\"ratingCount\", ascending = False)\nactive_days.show()\n","user":"anonymous","dateUpdated":"2024-11-12T19:29:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731439769991_-1830072511","id":"20241112-192929_2130094777","dateCreated":"2024-11-12T19:29:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3918","dateFinished":"2024-11-12T19:29:53+0000","dateStarted":"2024-11-12T19:29:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----------+\n|day_of_week|ratingCount|\n+-----------+-----------+\n|          4|      16621|\n|          6|      15918|\n|          7|      15077|\n|          3|      13933|\n|          5|      13364|\n|          2|      13174|\n|          1|      11913|\n+-----------+-----------+\n\n"}]}},{"text":"%pyspark\nmovies_dates_grouped = movies_data_formatted.groupby(['year', 'month', 'day_of_week']).agg(count(\"rating\").alias(\"ratingCount\")).orderBy(\"ratingCount\", ascending = False)\nmovies_dates_grouped.show(5)","user":"anonymous","dateUpdated":"2024-11-12T19:37:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731439963418_-1069733708","id":"20241112-193243_2098427669","dateCreated":"2024-11-12T19:32:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4005","dateFinished":"2024-11-12T19:37:37+0000","dateStarted":"2024-11-12T19:37:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+-----------+-----------+\n|year|month|day_of_week|ratingCount|\n+----+-----+-----------+-----------+\n|1997|   11|          5|       5476|\n|1997|   11|          6|       4621|\n|1998|    3|          3|       3517|\n|1997|   11|          4|       3430|\n|1998|    1|          6|       3278|\n+----+-----+-----------+-----------+\nonly showing top 5 rows\n\n"}]}},{"text":"%sql\nCREATE TABLE IF NOT EXISTS dates_ratings_count (\n    year INT,\n    month INT,\n    day_of_week INT,\n    ratingCount INT\n)\nSTORED AS PARQUET","user":"anonymous","dateUpdated":"2024-11-12T19:38:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731440285435_533193675","id":"20241112-193805_1806296695","dateCreated":"2024-11-12T19:38:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4211","dateFinished":"2024-11-12T19:38:52+0000","dateStarted":"2024-11-12T19:38:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]}},{"text":"%pyspark\n\nmovies_dates_grouped.write.mode(\"overwrite\").saveAsTable(\"dates_ratings_count\")","user":"anonymous","dateUpdated":"2024-11-12T19:40:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731440411736_-1849019917","id":"20241112-194011_1908139943","dateCreated":"2024-11-12T19:40:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4531","dateFinished":"2024-11-12T19:41:11+0000","dateStarted":"2024-11-12T19:40:50+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\nselect year, sum(ratingCount) as ratingCount from dates_ratings_count group by year","user":"anonymous","dateUpdated":"2024-11-12T19:47:04+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731440339556_-503243241","id":"20241112-193859_2096588895","dateCreated":"2024-11-12T19:38:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4358","dateFinished":"2024-11-12T19:47:02+0000","dateStarted":"2024-11-12T19:47:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tratingCount\n1997\t52899\n1998\t47101\n"}]}},{"text":"%sql\nselect month, sum(ratingCount) as ratingCount from dates_ratings_count group by month order by ratingCount desc","user":"anonymous","dateUpdated":"2024-11-12T20:04:41+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731440833018_501625652","id":"20241112-194713_1656811902","dateCreated":"2024-11-12T19:47:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5156","dateFinished":"2024-11-12T20:04:15+0000","dateStarted":"2024-11-12T20:04:08+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"month\tratingCount\n11\t23980\n1\t14095\n3\t12656\n12\t11911\n2\t10991\n10\t10304\n4\t9359\n9\t6704\n"}]}},{"text":"%sql\nselect day_of_week, sum(ratingCount) as ratingCount from dates_ratings_count group by day_of_week order by ratingCount desc","user":"anonymous","dateUpdated":"2024-11-12T20:06:02+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731441921692_-918891358","id":"20241112-200521_119680861","dateCreated":"2024-11-12T20:05:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6002","dateFinished":"2024-11-12T20:05:56+0000","dateStarted":"2024-11-12T20:05:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"day_of_week\tratingCount\n4\t16621\n6\t15918\n7\t15077\n3\t13933\n5\t13364\n2\t13174\n1\t11913\n"}]}},{"text":"%pyspark\nmovies_items = spark.read.csv(items, sep = '|' , header = False , inferSchema=True).toDF(\"movie_id\",\"movie_name\" ,\"release_date\" ,\"release_video\" ,\"imdb_link\",\"unknown\", \"Action\", \"Adventure\", \"Animation\", \"Children's\", \"Comedy\", \"Crime\", \"Documentary\", \n           \"Drama\", \"Fantasy\", \"Film-Noir\", \"Horror\", \"Musical\", \"Mystery\", \"Romance\", \"Sci-Fi\", \"Thriller\", \n           \"War\", \"Western\")","user":"anonymous","dateUpdated":"2024-11-12T18:38:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731419990511_-2093397437","id":"20241112-135950_2013322883","dateCreated":"2024-11-12T13:59:50+0000","dateStarted":"2024-11-12T18:16:46+0000","dateFinished":"2024-11-12T18:16:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:307"},{"text":"%pyspark\nmovies_items.show(5)","user":"anonymous","dateUpdated":"2024-11-12T18:38:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------------+------------+-------------+--------------------+-------+------+---------+---------+----------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\n|movie_id|       movie_name|release_date|release_video|           imdb_link|unknown|Action|Adventure|Animation|Children's|Comedy|Crime|Documentary|Drama|Fantasy|Film-Noir|Horror|Musical|Mystery|Romance|Sci-Fi|Thriller|War|Western|\n+--------+-----------------+------------+-------------+--------------------+-------+------+---------+---------+----------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\n|       1| Toy Story (1995)| 01-Jan-1995|         null|http://us.imdb.co...|      0|     0|        0|        1|         1|     1|    0|          0|    0|      0|        0|     0|      0|      0|      0|     0|       0|  0|      0|\n|       2| GoldenEye (1995)| 01-Jan-1995|         null|http://us.imdb.co...|      0|     1|        1|        0|         0|     0|    0|          0|    0|      0|        0|     0|      0|      0|      0|     0|       1|  0|      0|\n|       3|Four Rooms (1995)| 01-Jan-1995|         null|http://us.imdb.co...|      0|     0|        0|        0|         0|     0|    0|          0|    0|      0|        0|     0|      0|      0|      0|     0|       1|  0|      0|\n|       4|Get Shorty (1995)| 01-Jan-1995|         null|http://us.imdb.co...|      0|     1|        0|        0|         0|     1|    0|          0|    1|      0|        0|     0|      0|      0|      0|     0|       0|  0|      0|\n|       5|   Copycat (1995)| 01-Jan-1995|         null|http://us.imdb.co...|      0|     0|        0|        0|         0|     0|    1|          0|    1|      0|        0|     0|      0|      0|      0|     0|       1|  0|      0|\n+--------+-----------------+------------+-------------+--------------------+-------+------+---------+---------+----------+------+-----+-----------+-----+-------+---------+------+-------+-------+-------+------+--------+---+-------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731420250038_-574628775","id":"20241112-140410_2088073517","dateCreated":"2024-11-12T14:04:10+0000","dateStarted":"2024-11-12T18:16:48+0000","dateFinished":"2024-11-12T18:16:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:308"},{"text":"%pyspark\nmovies_items_unpivoted = movies_items.selectExpr(\n    \"movie_id\",\n    \"movie_name\",\n    \"release_date\",\n    \"stack(18, 'Action', Action, 'Adventure', Adventure, 'Animation', Animation, \"\n    \"'Children''s', `Children's`, 'Comedy', Comedy, 'Crime', Crime, 'Documentary', Documentary, \"\n    \"'Drama', Drama, 'Fantasy', Fantasy, 'Film-Noir', `Film-Noir`, 'Horror', Horror, 'Musical', Musical, \"\n    \"'Mystery', Mystery, 'Romance', Romance, 'Sci-Fi', `Sci-Fi`, 'Thriller', Thriller, 'War', War, 'Western', Western) \"\n    \"as (type, value)\"\n)","user":"anonymous","dateUpdated":"2024-11-12T18:38:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731420262445_1356456603","id":"20241112-140422_527250605","dateCreated":"2024-11-12T14:04:22+0000","dateStarted":"2024-11-12T18:16:52+0000","dateFinished":"2024-11-12T18:16:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:309"},{"text":"%pyspark\nmovies_items_unpivoted = movies_items_unpivoted.filter(movies_items_unpivoted[\"value\"] == 1)\n\nmovies_items_unpivoted = movies_items_unpivoted.drop(\"value\")","user":"anonymous","dateUpdated":"2024-11-12T18:38:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731420930235_1158877914","id":"20241112-141530_691542156","dateCreated":"2024-11-12T14:15:30+0000","dateStarted":"2024-11-12T18:16:55+0000","dateFinished":"2024-11-12T18:16:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:310"},{"text":"%pyspark\nmovies_items_unpivoted.show(truncate=False)","user":"anonymous","dateUpdated":"2024-11-12T18:38:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------------------------------------------------+------------+---------+\n|movie_id|movie_name                                          |release_date|type     |\n+--------+----------------------------------------------------+------------+---------+\n|1       |Toy Story (1995)                                    |01-Jan-1995 |Animation|\n|1       |Toy Story (1995)                                    |01-Jan-1995 |Childrens|\n|1       |Toy Story (1995)                                    |01-Jan-1995 |Comedy   |\n|2       |GoldenEye (1995)                                    |01-Jan-1995 |Action   |\n|2       |GoldenEye (1995)                                    |01-Jan-1995 |Adventure|\n|2       |GoldenEye (1995)                                    |01-Jan-1995 |Thriller |\n|3       |Four Rooms (1995)                                   |01-Jan-1995 |Thriller |\n|4       |Get Shorty (1995)                                   |01-Jan-1995 |Action   |\n|4       |Get Shorty (1995)                                   |01-Jan-1995 |Comedy   |\n|4       |Get Shorty (1995)                                   |01-Jan-1995 |Drama    |\n|5       |Copycat (1995)                                      |01-Jan-1995 |Crime    |\n|5       |Copycat (1995)                                      |01-Jan-1995 |Drama    |\n|5       |Copycat (1995)                                      |01-Jan-1995 |Thriller |\n|6       |Shanghai Triad (Yao a yao yao dao waipo qiao) (1995)|01-Jan-1995 |Drama    |\n|7       |Twelve Monkeys (1995)                               |01-Jan-1995 |Drama    |\n|7       |Twelve Monkeys (1995)                               |01-Jan-1995 |Sci-Fi   |\n|8       |Babe (1995)                                         |01-Jan-1995 |Childrens|\n|8       |Babe (1995)                                         |01-Jan-1995 |Comedy   |\n|8       |Babe (1995)                                         |01-Jan-1995 |Drama    |\n|9       |Dead Man Walking (1995)                             |01-Jan-1995 |Drama    |\n+--------+----------------------------------------------------+------------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731420497318_-1671195433","id":"20241112-140817_1460558331","dateCreated":"2024-11-12T14:08:17+0000","dateStarted":"2024-11-12T18:16:59+0000","dateFinished":"2024-11-12T18:17:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:311"},{"text":"%pyspark\nfrom pyspark.sql import functions as F\n\nmovies_items_data = movies_items_unpivoted.groupBy(\"movie_id\", \"movie_name\", \"release_date\") \\\n    .agg(F.concat_ws(\", \", F.collect_list(\"type\")).alias(\"types\"))","user":"anonymous","dateUpdated":"2024-11-12T20:25:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731443091500_111770144","id":"20241112-202451_1825685246","dateCreated":"2024-11-12T20:24:51+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6831"},{"text":"%pyspark\nmovies_items_data.show(5)","user":"anonymous","dateUpdated":"2024-11-12T18:38:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------+------------+--------------------+\n|movie_id|          movie_name|release_date|               types|\n+--------+--------------------+------------+--------------------+\n|     183|        Alien (1979)| 01-Jan-1979|Action, Horror, S...|\n|     355|       Sphere (1998)| 13-Feb-1998|Adventure, Sci-Fi...|\n|     646|Once Upon a Time ...| 01-Jan-1969|             Western|\n|     879|Peacemaker, The (...| 01-Jan-1997|Action, Thriller,...|\n|    1013|     Anaconda (1997)| 11-Apr-1997|Action, Adventure...|\n+--------+--------------------+------------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731421089831_-260077674","id":"20241112-141809_1618822193","dateCreated":"2024-11-12T14:18:09+0000","dateStarted":"2024-11-12T18:17:07+0000","dateFinished":"2024-11-12T18:17:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:313"},{"text":"%pyspark\nmovies_agg = movies_data_formatted.groupby(\"movie_id\").agg(count(\"rating\").alias(\"ratingCount\"), round(avg(\"rating\"),2).alias(\"avgRating\"))\nmovies_agg.show(5)\n","user":"anonymous","dateUpdated":"2024-11-12T20:19:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731442700996_-511272954","id":"20241112-201820_206798168","dateCreated":"2024-11-12T20:18:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6525","dateFinished":"2024-11-12T20:19:18+0000","dateStarted":"2024-11-12T20:19:18+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------+---------+\n|movie_id|ratingCount|avgRating|\n+--------+-----------+---------+\n|     496|        231|     4.12|\n|     471|        221|     3.61|\n|     463|         71|     3.86|\n|     148|        128|      3.2|\n|    1342|          2|      2.5|\n+--------+-----------+---------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\nmovies_df = movies_agg.join(movies_items_data, on=\"movie_id\", how= \"left\")\nmovies_df.show(5)","user":"anonymous","dateUpdated":"2024-11-12T20:19:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------+---------+--------------------+------------+-----------------+\n|movie_id|ratingCount|avgRating|          movie_name|release_date|            types|\n+--------+-----------+---------+--------------------+------------+-----------------+\n|     496|        231|     4.12|It's a Wonderful ...| 01-Jan-1946|            Drama|\n|     471|        221|     3.61|Courage Under Fir...| 08-Mar-1996|       Drama, War|\n|     463|         71|     3.86|Secret of Roan In...| 01-Jan-1994|        Adventure|\n|     148|        128|      3.2|Ghost and the Dar...| 11-Oct-1996|Action, Adventure|\n|    1342|          2|      2.5|Convent, The (Con...| 14-Jun-1996|            Drama|\n+--------+-----------+---------+--------------------+------------+-----------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1731421153573_-1505217060","id":"20241112-141913_1183790416","dateCreated":"2024-11-12T14:19:13+0000","dateStarted":"2024-11-12T20:19:39+0000","dateFinished":"2024-11-12T20:19:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:314"},{"text":"%sql\nCREATE TABLE IF NOT EXISTS movie_details (\n    movie_id INT,\n    ratingCount INT,\n    avgRating DOUBLE,\n    movie_name STRING,\n    release_date STRING,\n    types STRING\n)\nSTORED AS PARQUET\n\n","user":"anonymous","dateUpdated":"2024-11-12T20:21:01+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":""}]},"apps":[],"jobName":"paragraph_1731434826811_-1180661219","id":"20241112-180706_992014275","dateCreated":"2024-11-12T18:07:06+0000","dateStarted":"2024-11-12T20:21:01+0000","dateFinished":"2024-11-12T20:21:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:315"},{"text":"%pyspark\n\nmovies_df.write.mode(\"overwrite\").saveAsTable(\"movie_details\")","user":"anonymous","dateUpdated":"2024-11-12T20:23:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1731435040732_2129837098","id":"20241112-181040_1313223121","dateCreated":"2024-11-12T18:10:40+0000","dateStarted":"2024-11-12T20:23:16+0000","dateFinished":"2024-11-12T20:24:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:316"},{"text":"%sql\r\nSELECT * FROM movie_details LIMIT 10\r\n","user":"anonymous","dateUpdated":"2024-11-12T20:25:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_id\tratingCount\tavgRating\tmovie_name\trelease_date\ttypes\n1042\t28\t3.14\tJust Cause (1995)\t01-Jan-1995\tMystery, Thriller\n98\t390\t4.29\tSilence of the Lambs, The (1991)\t01-Jan-1991\tDrama, Thriller\n195\t301\t3.93\tTerminator, The (1984)\t01-Jan-1984\tAction, Sci-Fi, Thriller\n256\t16\t3.56\tWhen the Cats Away (Chacun cherche son chat) (1996)\t20-Jun-1997\tComedy, Romance\n678\t219\t2.81\tVolcano (1997)\t25-Apr-1997\tDrama, Thriller\n714\t13\t3.23\tCarrington (1995)\t01-Jan-1995\tDrama, Romance\n1348\t1\t1.0\tEvery Other Weekend (1990)\t01-Jan-1990\tDrama\n1364\t1\t1.0\tBird of Prey (1996)\t04-Oct-1996\tAction\n1131\t13\t4.0\tSafe (1995)\t01-Jan-1995\tThriller\n933\t21\t2.43\tFuneral, The (1996)\t25-Oct-1996\tDrama\n"}]},"apps":[],"jobName":"paragraph_1731435358819_-300962125","id":"20241112-181558_88974885","dateCreated":"2024-11-12T18:15:58+0000","dateStarted":"2024-11-12T20:25:02+0000","dateFinished":"2024-11-12T20:25:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:317"},{"text":"%sql\nSELECT * FROM movie_details order by ratingCount desc limit 10 ","user":"anonymous","dateUpdated":"2024-11-12T20:49:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731444357685_1443963472","id":"20241112-204557_32152410","dateCreated":"2024-11-12T20:45:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8827","dateFinished":"2024-11-12T20:49:54+0000","dateStarted":"2024-11-12T20:49:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_id\tratingCount\tavgRating\tmovie_name\trelease_date\ttypes\n50\t583\t4.36\tStar Wars (1977)\t01-Jan-1977\tAction, Adventure, Romance, Sci-Fi, War\n258\t509\t3.8\tContact (1997)\t11-Jul-1997\tDrama, Sci-Fi\n100\t508\t4.16\tFargo (1996)\t14-Feb-1997\tCrime, Drama, Thriller\n181\t507\t4.01\tReturn of the Jedi (1983)\t14-Mar-1997\tAction, Adventure, Romance, Sci-Fi, War\n294\t485\t3.16\tLiar Liar (1997)\t21-Mar-1997\tComedy\n286\t481\t3.66\tEnglish Patient, The (1996)\t15-Nov-1996\tDrama, Romance, War\n288\t478\t3.44\tScream (1996)\t20-Dec-1996\tHorror, Thriller\n1\t452\t3.88\tToy Story (1995)\t01-Jan-1995\tAnimation, Childrens, Comedy\n300\t431\t3.63\tAir Force One (1997)\t01-Jan-1997\tAction, Thriller\n121\t429\t3.44\tIndependence Day (ID4) (1996)\t03-Jul-1996\tAction, Sci-Fi, War\n"}]}},{"text":"%sql\nSELECT * FROM movie_details where ratingCount >=10 order by avgRating desc limit 10 ","user":"anonymous","dateUpdated":"2024-11-12T20:51:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731444608398_899511486","id":"20241112-205008_236560443","dateCreated":"2024-11-12T20:50:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9098","dateFinished":"2024-11-12T20:51:09+0000","dateStarted":"2024-11-12T20:51:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_id\tratingCount\tavgRating\tmovie_name\trelease_date\ttypes\n408\t112\t4.49\tClose Shave, A (1995)\t28-Apr-1996\tAnimation, Comedy, Thriller\n169\t118\t4.47\tWrong Trousers, The (1993)\t01-Jan-1993\tAnimation, Comedy\n318\t298\t4.47\tSchindler's List (1993)\t01-Jan-1993\tDrama, War\n483\t243\t4.46\tCasablanca (1942)\t01-Jan-1942\tDrama, Romance, War\n64\t283\t4.45\tShawshank Redemption, The (1994)\t01-Jan-1994\tDrama\n114\t67\t4.45\tWallace & Gromit: The Best of Aardman Animation (1996)\t05-Apr-1996\tAnimation\n603\t209\t4.39\tRear Window (1954)\t01-Jan-1954\tMystery, Thriller\n12\t267\t4.39\tUsual Suspects, The (1995)\t14-Aug-1995\tCrime, Thriller\n50\t583\t4.36\tStar Wars (1977)\t01-Jan-1977\tAction, Adventure, Romance, Sci-Fi, War\n178\t125\t4.34\t12 Angry Men (1957)\t01-Jan-1957\tDrama\n"}]}},{"text":"%sql\nSELECT * FROM movie_details where ratingCount >=10 order by avgRating limit 10 ","user":"anonymous","dateUpdated":"2024-11-12T20:51:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731444690285_-1751485057","id":"20241112-205130_239063703","dateCreated":"2024-11-12T20:51:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9351","dateFinished":"2024-11-12T20:51:48+0000","dateStarted":"2024-11-12T20:51:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movie_id\tratingCount\tavgRating\tmovie_name\trelease_date\ttypes\n424\t19\t1.32\tChildren of the Corn: The Gathering (1996)\t01-Jan-1996\tHorror\n669\t13\t1.62\tBody Parts (1991)\t01-Jan-1991\tHorror\n440\t14\t1.64\tAmityville II: The Possession (1982)\t01-Jan-1982\tHorror\n1087\t10\t1.7\tBloodsport 2 (1995)\t01-Mar-1996\tAction\n758\t21\t1.71\tLawnmower Man 2: Beyond Cyberspace (1996)\t01-Jan-1996\tSci-Fi, Thriller\n1274\t11\t1.73\tRobocop 3 (1993)\t01-Jan-1993\tSci-Fi, Thriller\n457\t27\t1.74\tFree Willy 3: The Rescue (1997)\t08-Aug-1997\tAdventure, Childrens, Drama\n1336\t10\t1.8\tKazaam (1996)\t17-Jul-1996\tChildrens, Comedy, Fantasy\n1254\t11\t1.82\tGone Fishin' (1997)\t30-May-1997\tComedy\n1230\t18\t1.83\tReady to Wear (Pret-A-Porter) (1994)\t01-Jan-1994\tComedy\n"}]}},{"text":"%pyspark\ntop_type = movies_items_unpivoted.join(movies_data_formatted, on=\"movie_id\", how= \"left\")\ntop_type.show(5)","user":"anonymous","dateUpdated":"2024-11-12T20:37:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731435472384_-403169059","id":"20241112-181752_579733083","dateCreated":"2024-11-12T18:17:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:318","dateFinished":"2024-11-12T20:37:28+0000","dateStarted":"2024-11-12T20:37:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+----------------+------------+---------+-------+------+-------------------+----+-----+-----------+\n|movie_id|      movie_name|release_date|     type|user_id|rating|          timestamp|year|month|day_of_week|\n+--------+----------------+------------+---------+-------+------+-------------------+----+-----+-----------+\n|       1|Toy Story (1995)| 01-Jan-1995|Animation|    593|     3|1997-09-30 22:39:10|1997|    9|          3|\n|       1|Toy Story (1995)| 01-Jan-1995|Animation|    800|     4|1998-02-16 16:24:43|1998|    2|          2|\n|       1|Toy Story (1995)| 01-Jan-1995|Animation|    786|     4|1997-12-23 01:50:28|1997|   12|          3|\n|       1|Toy Story (1995)| 01-Jan-1995|Animation|    747|     5|1998-02-28 04:12:18|1998|    2|          7|\n|       1|Toy Story (1995)| 01-Jan-1995|Animation|    895|     4|1997-11-13 16:19:10|1997|   11|          5|\n+--------+----------------+------------+---------+-------+------+-------------------+----+-----+-----------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\ntop_movie_type = top_type.groupby(\"type\").agg(count(\"rating\").alias(\"total_ratings\"), round(avg(\"rating\"),2).alias(\"avgRating\"))\ntop_movie_type.show(5)","user":"anonymous","dateUpdated":"2024-11-12T20:38:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731442294793_125302586","id":"20241112-201134_184102478","dateCreated":"2024-11-12T20:11:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6304","dateFinished":"2024-11-12T20:38:50+0000","dateStarted":"2024-11-12T20:38:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-------------+---------+\n|     type|total_ratings|avgRating|\n+---------+-------------+---------+\n|    Crime|         8055|     3.63|\n|  Romance|        19461|     3.62|\n| Thriller|        21872|     3.51|\n|Adventure|        13753|      3.5|\n|    Drama|        39895|     3.69|\n+---------+-------------+---------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\ntop_movie_type.createOrReplaceTempView(\"movies_data_view\")","user":"anonymous","dateUpdated":"2024-11-12T20:40:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731443517383_-1427751936","id":"20241112-203157_880238076","dateCreated":"2024-11-12T20:31:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7137","dateFinished":"2024-11-12T20:40:15+0000","dateStarted":"2024-11-12T20:40:14+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\r\nSELECT * FROM movies_data_view order by total_ratings desc limit 10\r\n","user":"anonymous","dateUpdated":"2024-11-12T20:43:02+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731443965674_-762893801","id":"20241112-203925_1625787130","dateCreated":"2024-11-12T20:39:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7356","dateFinished":"2024-11-12T20:42:13+0000","dateStarted":"2024-11-12T20:42:11+0000","title":"Top genres in Rating count","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"type\ttotal_ratings\tavgRating\nDrama\t39895\t3.69\nComedy\t29832\t3.39\nAction\t25589\t3.48\nThriller\t21872\t3.51\nRomance\t19461\t3.62\nAdventure\t13753\t3.5\nSci-Fi\t12730\t3.56\nWar\t9398\t3.82\nCrime\t8055\t3.63\nChildrens\t7182\t3.35\n"}]}},{"text":"%sql\nSELECT * FROM movies_data_view order by avgRating desc limit 5\n","user":"anonymous","dateUpdated":"2024-11-12T20:45:28+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"type","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgRating","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731444028485_-1945319116","id":"20241112-204028_1195300521","dateCreated":"2024-11-12T20:40:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7450","dateFinished":"2024-11-12T20:44:24+0000","dateStarted":"2024-11-12T20:44:21+0000","title":"Top genres in Avg Rating","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"type\ttotal_ratings\tavgRating\nFilm-Noir\t1733\t3.92\nWar\t9398\t3.82\nDrama\t39895\t3.69\nDocumentary\t758\t3.67\nMystery\t5245\t3.64\n"}]}},{"text":"%pyspark\nfrom pyspark.sql.functions import to_date, year\n\nrelease_year_date = movies_df.withColumn(\"release_date\", to_date(\"release_date\", \"dd-MMM-yyyy\"))","user":"anonymous","dateUpdated":"2024-11-12T21:05:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731444163354_1277135168","id":"20241112-204243_1377134816","dateCreated":"2024-11-12T20:42:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7958","dateFinished":"2024-11-12T21:05:10+0000","dateStarted":"2024-11-12T21:05:10+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nrelease_year = release_year_date.withColumn(\"year\", year(\"release_date\"))\nrelease_year.show(5)","user":"anonymous","dateUpdated":"2024-11-12T21:05:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731444994032_1752082756","id":"20241112-205634_1858332712","dateCreated":"2024-11-12T20:56:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9524","dateFinished":"2024-11-12T21:05:17+0000","dateStarted":"2024-11-12T21:05:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+-----------+---------+--------------------+------------+-----------------+----+\n|movie_id|ratingCount|avgRating|          movie_name|release_date|            types|year|\n+--------+-----------+---------+--------------------+------------+-----------------+----+\n|     496|        231|     4.12|It's a Wonderful ...|  1946-01-01|            Drama|1946|\n|     471|        221|     3.61|Courage Under Fir...|  1996-03-08|       Drama, War|1996|\n|     463|         71|     3.86|Secret of Roan In...|  1994-01-01|        Adventure|1994|\n|     148|        128|      3.2|Ghost and the Dar...|  1996-10-11|Action, Adventure|1996|\n|    1342|          2|      2.5|Convent, The (Con...|  1996-06-14|            Drama|1996|\n+--------+-----------+---------+--------------------+------------+-----------------+----+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\ntop_release_year = release_year.createOrReplaceTempView(\"top_release_year\")","user":"anonymous","dateUpdated":"2024-11-12T21:06:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731445204796_590816986","id":"20241112-210004_1127272347","dateCreated":"2024-11-12T21:00:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9692","dateFinished":"2024-11-12T21:06:07+0000","dateStarted":"2024-11-12T21:06:07+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%sql\nselect year, count(movie_id) as production_count from top_release_year group by year order by production_count desc limit 5 ","user":"anonymous","dateUpdated":"2024-11-12T21:10:06+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731445231107_425790356","id":"20241112-210031_1624529070","dateCreated":"2024-11-12T21:00:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9801","dateFinished":"2024-11-12T21:09:52+0000","dateStarted":"2024-11-12T21:09:40+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\tproduction_count\n1996\t355\n1997\t286\n1995\t219\n1994\t214\n1993\t126\n"}]}},{"text":"%sql\nselect year, sum(ratingCount) as top_ratedmovies_year from top_release_year group by year order by top_ratedmovies_year desc limit 5 ","user":"anonymous","dateUpdated":"2024-11-12T21:11:39+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731445298889_679632685","id":"20241112-210138_853623924","dateCreated":"2024-11-12T21:01:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9926","dateFinished":"2024-11-12T21:11:30+0000","dateStarted":"2024-11-12T21:11:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"year\ttop_ratedmovies_year\n1996\t19708\n1997\t17393\n1995\t10499\n1994\t8893\n1993\t6657\n"}]}},{"text":"%sql\n","user":"anonymous","dateUpdated":"2024-11-12T21:11:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1731445865162_1740795342","id":"20241112-211105_1129251724","dateCreated":"2024-11-12T21:11:05+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10748"}],"name":"processing","id":"2KDM6SM6V","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}